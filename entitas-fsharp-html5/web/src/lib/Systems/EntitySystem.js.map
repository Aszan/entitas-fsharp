{"version":3,"sources":["../../../../lib/Systems/EntitySystem.fs"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAoBc;AAAA,+BAEU;AAAA;;AAEF;AAAA;AAAA,4CAGC,iBAAH,GACI;AAAA;AACC;AAAwB,qBADzB,EADJ,GAII,2BAAI,2BAAJ,CAPF,GACE,oBADF;AAAA;AAAA;;AASA;AACV,8BAAoB,0BAAoC;AAAA;AAAA,aAApC,CAApB;AAGiB;AAFjB;AAbmB,SAAP,EAFV,GAqBI;AAAA;;AAAA;AAEI;AAAA;AAAA;AAAA;;AAAA,yDAGF;AAAA;AAAA;AAAA;AAKmB;AARjB,wCAIF,4NAJE;AASD,6BATC;AAAA;AAAA;AAAY;AAAZ;AAAY;;AAWZ;AAAA;AAAA;AAAA;;AAAA,0DAGN;AAAA;AAAA;;AAIuB,yGAA2B,UAA3B,YAAuC,MAAvC;;AACG;AARpB,wCAIN,8NAJM;AASD,6BATC;AAAA;AAAA;AAAa;AAAb;AAAa;;AAWb;AAAA;AAAA;AAAA;;AAAA,2DAGF;AAAA;AAAA;;AAImB,0GAA2B,UAA3B,YAAuC,OAAvC;;AACG;;AARpB,wCAIF,iOAJE;AASD,6BATC;AAAA;AAAA;AAAa;AAAb;AAAa;;AAWb;AAAA;AAAA;AAAA;;AAAA,2DAGF;AAAA;AAAA;;AAImB,0GAA2B,WAA3B,YAAwC,OAAxC;;AACG;;AARpB,wCAIF,kOAJE;AASD,6BATC;AAAA;AAAA;AAAa;AAAb;AAAa;;AAWb;AAAA;AAAA;AAAA;;AAAA,2DAGF;AAAA;AAAA;AAAA;AAKqB;;AACF;;AATjB,wCAIF,0NAJE;AAUD,6BAVC;AAAA;AAAA;AAAe;AAAf;AAAe;;AAYf;AAAA;AAAA;AAAA;;AAAA,2DAGF;AAAA;AAAA;AAAA;;AAKqB;;AACF;;AATjB,wCAIF,4NAJE;AAUD,6BAVC;AAAA;AAAA;AAAU;AAAV;AAAU;;AA1Dd;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAY,SAAZ,EArBJ;AAAa","file":"EntitySystem.js","sourcesContent":["namespace Systems\n\n#if HTML5\nopen Fable.Core\nopen Fable.Import\nopen Fable.Import.Browser\nopen Fable.Core.JsInterop\nopen Bosco\n#endif\nopen Components\nopen Entities\nopen System.Collections.Generic\n\n[<AutoOpen>]\nmodule EntitySystemModule =\n    (**\n    * Activate / Deactiveate Entities as needed \n    *)\n    let EntitySystem (game:SystemInterface, width: int, height: int) entity =\n\n        match entity.Active with\n        | true -> \n            let mutable removed = false\n            let rec removeIf l predicate =\n                match l with\n                | [] -> []\n                | x::rest -> \n                    if predicate(x) then \n                        removed <- true\n                        (removeIf rest predicate) \n                    else \n                        x::(removeIf rest predicate)\n\n            let len = game.Deactivate.Length\n            game.Deactivate <- (removeIf game.Deactivate (fun id -> id = entity.Id))\n            {\n                entity with \n                    Active = not removed;\n            }\n\n        | false -> \n            match entity.Layer with\n            | Layer.BULLET ->\n                match game.Bullets with\n                | [] -> entity\n                | bullet :: rest ->\n                    game.Bullets <- rest\n                    {            \n                        entity with\n                            Active = true;\n                            Expires = Some(0.5);                        \n                            Position = CreatePoint(bullet.X, bullet.Y);\n                    }\n            | Layer.ENEMY1 ->\n                match game.Enemies1 with\n                | [] -> entity\n                | enemy :: rest ->\n                game.Enemies1 <- rest\n                {\n                        entity with \n                            Active = true;\n                            Position = CreatePoint(float(rnd.Next(width-35)), 91./2.0);\n                            Health = Some(CreateHealth(10, 10));\n                    }\n            | Layer.ENEMY2 ->\n                match game.Enemies2 with\n                | [] -> entity\n                | enemy :: rest ->\n                    game.Enemies2 <- rest\n                    {\n                        entity with \n                            Active = true;\n                            Position = CreatePoint(float(rnd.Next(width-86)), 172./2.);\n                            Health = Some(CreateHealth(20, 20));                \n                    }\n            | Layer.ENEMY3 ->\n                match game.Enemies3 with\n                | [] -> entity\n                | enemy :: rest ->\n                    game.Enemies3 <- rest\n                    {\n                        entity with \n                            Active = true;\n                            Position = CreatePoint(float(rnd.Next(width-160)), 320./2.);\n                            Health = Some(CreateHealth(60, 60));                \n                    }\n            | Layer.EXPLOSION ->\n                match game.Explosions with\n                | [] -> entity\n                | exp :: rest ->\n                    game.Explosions <- rest\n                    {\n                        entity with \n                            Active = true;\n                            Expires = Some(0.2);                        \n                            Scale = Some(CreatePoint(exp.Scale, exp.Scale));\n                            Position = CreatePoint(exp.X, exp.Y);\n                    }\n            | Layer.BANG ->\n                match game.Bangs with\n                | [] -> entity\n                | exp :: rest ->\n                    game.Bangs <- rest\n                    {\n                        entity with \n                            Active = true;\n                            Expires = Some(0.2);                        \n                            Scale = Some(CreatePoint(exp.Scale, exp.Scale));\n                            Position = CreatePoint(exp.X, exp.Y);\n                    }\n            | _ -> entity\n\n"]}